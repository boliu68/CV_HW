#Single view modeling
##Author: 
**Runze Zhang**, rzhangaj@cse.ust.hk

**Bo Liu**, bliuab@cse.ust.hk

## Approach:
- Get vanish points: 

	Let users to specify two end points of at least 2 lines for 3 orthogonal directions. The method to compute vanishing point is Bob Collin's method. Eigenvalue decomposition is done by openCV function.

	Set reference point and compute the Homography of reference plane. The user must set origin point in the image, and then select one reference point in each orthogonal directions (along x axis, along y axis, along z axis), and input the length between each reference point to origin point. XY plane is set as reference plane. By origin point, reference point in x, reference point in y and vanishing point in x and y directions, the coordinate of fourth point in image space is computed to compose a rectangle with other 3 points. Then we use (0, 0), (xlength, 0), (xlength, ylength), (0,ylength) in reference plane space and corresponding coordinates in image plane space to compute Homography by method in the lecture.
	
- Compute 3D coordinate:

	For points in reference plane, 3D coordinate is directly computed by homograph.

	For points not in reference plane, the user need to first specify a point in reference plane whose has the same X and Y coordinate in 3D space. 3D coordinate of point in reference plane is first computed, then the height of the top point is gotten by method in the lecture.

- Texture Mapping:
	
	User need to select at least 3 points to generate a face. If there are 3 points, the 4th point is generated by the 3 points to construct a parallelogram.

	If a face is not a rectangle, we will construct a rectangle to enclose it. We choose the corner with smallest angle among the face’s corners as the first corner of the rectangle. Then the longer edge from that corner is selected as the direction of the rectangle to be constructed. Then the corner of the face which is farthest to this edge and the corner which is farthest to the plane vertical to the edge are selected. By this three corners and the edge, the other 3 corners of the rectangle are obtained.
The width and height of the rectangle in 3D space is the width and height of the texture. Before generating the face, the user must compute their 3D coordinates.

- Camera location:
	
	We use the Homography of the reference plane as the 1st, 2nd and 4th column of P, and compute the scale of the 3rd column of p by reference point in z direction. Note Camera location as C, then PC=0. We get C by the SVD functions of openCV.

##Analysis of the result
Now, there is no way to compute the 3D coordination of a point in a plane parallel to reference plane containing a knowing point not in the reference plane. So the ceil in the indoor image is not good, for the reason that the user must specify the bottom point of the ceil corner and one of the ceil corner’s bottom point is occluded, which require user to guess.


##Extension
Next we want to make up the situation that doesn’t work now.
And in fact, I find that if we assume the element in the first row and second column of intrinsic matrix is 0, which means there is no skew, only need the origin point be specified. If we specify the camera center as the origin point, no reference point need be specified besides 3 vanishing point. By the method in Multiple View Geometry, intrinsic matrix can be obtained by 3 vanish point. We can assume the height of camera is 1, and then we can get all the point in the ground plane. Then with the point in the ground plane as bottom point, the top point can be also obtained.

##The Birth of the Virgin [[1]]
by **Juan de Borgoña** 

[1]: http://commons.wikimedia.org/wiki/File:Juan_de_Borgo%C3%B1a_-_The_Birth_of_the_Virgin_-_WGA02473.jpg "Juan de Borgoña - The Birth of the Virgin. (n.d.). In Wikipedia. Retrieved 21, Mar, 2014, from http://commons.wikimedia.org/wiki/File:Juan_de_Borgo%C3%B1a_-_The_Birth_of_the_Virgin_-_WGA02473.jpg "

###Source image

![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/8DC44167-0C20-4255-AD8E-99C8600AACA6/result/painting/1.jpg)

![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/8DC44167-0C20-4255-AD8E-99C8600AACA6/result/painting/1_screenshot.png)

###Still View
![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/EC15F1FB-C706-4F40-8539-2BE5CD7F6C21/result/painting/wrlscreenshot1.png)

###Texture Map
![image](/Users/bliuab/Dropbox/Codes/CV_HW/p2/p2Submit/result/painting/1_008.png)

![image](/Users/bliuab/Dropbox/Codes/CV_HW/p2/p2Submit/result/painting/1_006.png)

![image](/Users/bliuab/Dropbox/Codes/CV_HW/p2/p2Submit/result/painting/1_011.png)

##Outdoor scene at night [[2]]
[2]: http://www.kerkythea.net/forum/viewtopic.php?f=9&t=11321

###Source Image

![image](/Users/bliuab/Dropbox/Codes/CV_HW/p2/p2Submit/result/outdoor/outdoor.jpg)

![image](/Users/bliuab/Dropbox/Codes/CV_HW/p2/p2Submit/result/outdoor/outdoor_screenshot.png)

###Still View
![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/EC15F1FB-C706-4F40-8539-2BE5CD7F6C21/result/outdoor/wrlscreenshot2.png)


###Texture Map

![image](/Users/bliuab/Dropbox/Codes/CV_HW/p2/p2Submit/result/outdoor/outdoor_000.png)

![image](/Users/bliuab/Dropbox/Codes/CV_HW/p2/p2Submit/result/outdoor/outdoor_016.png)

![image](/Users/bliuab/Dropbox/Codes/CV_HW/p2/p2Submit/result/outdoor/outdoor_003.png)

##Indoor Scence
Floor 4, lift 17

###Source Image
![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/EC15F1FB-C706-4F40-8539-2BE5CD7F6C21/result/indoor/indoor.png)

![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/EC15F1FB-C706-4F40-8539-2BE5CD7F6C21/result/indoor/indoor_screenshot.png)

###Still View

![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/EC15F1FB-C706-4F40-8539-2BE5CD7F6C21/result/indoor/wrlscreenshot1.png)

###Texture Map
![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/EC15F1FB-C706-4F40-8539-2BE5CD7F6C21/result/indoor/indoor_009.png)

![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/EC15F1FB-C706-4F40-8539-2BE5CD7F6C21/result/indoor/indoor_002.png)

![image](/Users/bliuab/Library/Containers/com.apple.mail/Data/Library/Mail Downloads/EC15F1FB-C706-4F40-8539-2BE5CD7F6C21/result/indoor/indoor_003.png)